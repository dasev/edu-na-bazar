"""
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
–ü–æ 100 —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –∫–∞–∂–¥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
"""
import psycopg2
import random
from datetime import datetime, timedelta

conn = psycopg2.connect(
    host="localhost",
    port=5432,
    database="edu_na_bazar",
    user="postgres",
    password="postgres"
)

cur = conn.cursor()

# –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
cur.execute("SELECT id, name FROM market.categories ORDER BY id")
categories = cur.fetchall()

print(f"üìä –ù–∞–π–¥–µ–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {len(categories)}\n")

# –®–∞–±–ª–æ–Ω—ã –Ω–∞–∑–≤–∞–Ω–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
product_templates = {
    '–û–≤–æ—â–∏': [
        '–ü–æ–º–∏–¥–æ—Ä—ã {—Å–æ—Ä—Ç} {—Ä–∞–∑–º–µ—Ä}',
        '–û–≥—É—Ä—Ü—ã {—Å–æ—Ä—Ç} —Å–≤–µ–∂–∏–µ',
        '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å {—Å–æ—Ä—Ç} {—Ä–∞–∑–º–µ—Ä}',
        '–ú–æ—Ä–∫–æ–≤—å {—Å–æ—Ä—Ç} —Å–æ—á–Ω–∞—è',
        '–ö–∞–ø—É—Å—Ç–∞ {—Å–æ—Ä—Ç} {—Ä–∞–∑–º–µ—Ä}',
        '–°–≤–µ–∫–ª–∞ {—Å–æ—Ä—Ç} –æ—Ç–±–æ—Ä–Ω–∞—è',
        '–õ—É–∫ {—Å–æ—Ä—Ç} {—Ä–∞–∑–º–µ—Ä}',
        '–ß–µ—Å–Ω–æ–∫ {—Å–æ—Ä—Ç} –æ—Å—Ç—Ä—ã–π',
        '–ü–µ—Ä–µ—Ü {—Å–æ—Ä—Ç} {—Ü–≤–µ—Ç}',
        '–ë–∞–∫–ª–∞–∂–∞–Ω—ã {—Å–æ—Ä—Ç} —Å–≤–µ–∂–∏–µ'
    ],
    '–§—Ä—É–∫—Ç—ã': [
        '–Ø–±–ª–æ–∫–∏ {—Å–æ—Ä—Ç} {—Ä–∞–∑–º–µ—Ä}',
        '–ì—Ä—É—à–∏ {—Å–æ—Ä—Ç} —Å–æ—á–Ω—ã–µ',
        '–°–ª–∏–≤—ã {—Å–æ—Ä—Ç} —Å–ø–µ–ª—ã–µ',
        '–ê–±—Ä–∏–∫–æ—Å—ã {—Å–æ—Ä—Ç} —Å–ª–∞–¥–∫–∏–µ',
        '–ü–µ—Ä—Å–∏–∫–∏ {—Å–æ—Ä—Ç} {—Ä–∞–∑–º–µ—Ä}',
        '–í–∏–Ω–æ–≥—Ä–∞–¥ {—Å–æ—Ä—Ç} {—Ü–≤–µ—Ç}',
        '–ê—Ä–±—É–∑—ã {—Å–æ—Ä—Ç} —Å–ª–∞–¥–∫–∏–µ',
        '–î—ã–Ω–∏ {—Å–æ—Ä—Ç} –∞—Ä–æ–º–∞—Ç–Ω—ã–µ'
    ],
    '–Ø–≥–æ–¥—ã': [
        '–ö–ª—É–±–Ω–∏–∫–∞ {—Å–æ—Ä—Ç} –∫—Ä—É–ø–Ω–∞—è',
        '–ú–∞–ª–∏–Ω–∞ {—Å–æ—Ä—Ç} —Å–≤–µ–∂–∞—è',
        '–°–º–æ—Ä–æ–¥–∏–Ω–∞ {—Ü–≤–µ—Ç} {—Å–æ—Ä—Ç}',
        '–ö—Ä—ã–∂–æ–≤–Ω–∏–∫ {—Å–æ—Ä—Ç} —Å–ø–µ–ª—ã–π',
        '–ß–µ—Ä–Ω–∏–∫–∞ {—Å–æ—Ä—Ç} –ª–µ—Å–Ω–∞—è',
        '–ï–∂–µ–≤–∏–∫–∞ {—Å–æ—Ä—Ç} —Å–∞–¥–æ–≤–∞—è'
    ],
    '–ó–µ–ª–µ–Ω—å': [
        '–£–∫—Ä–æ–ø —Å–≤–µ–∂–∏–π –ø—É—á–æ–∫',
        '–ü–µ—Ç—Ä—É—à–∫–∞ {—Å–æ—Ä—Ç} –∑–µ–ª–µ–Ω–∞—è',
        '–°–∞–ª–∞—Ç {—Å–æ—Ä—Ç} —Ö—Ä—É—Å—Ç—è—â–∏–π',
        '–ë–∞–∑–∏–ª–∏–∫ {—Å–æ—Ä—Ç} –∞—Ä–æ–º–∞—Ç–Ω—ã–π',
        '–ö–∏–Ω–∑–∞ —Å–≤–µ–∂–∞—è –ø—É—á–æ–∫',
        '–†—É–∫–∫–æ–ª–∞ {—Å–æ—Ä—Ç} –º–æ–ª–æ–¥–∞—è'
    ],
    '–ú—è—Å–æ': [
        '–ì–æ–≤—è–¥–∏–Ω–∞ {—á–∞—Å—Ç—å} –æ—Ö–ª–∞–∂–¥–µ–Ω–Ω–∞—è',
        '–°–≤–∏–Ω–∏–Ω–∞ {—á–∞—Å—Ç—å} —Å–≤–µ–∂–∞—è',
        '–ö—É—Ä–∏—Ü–∞ {—á–∞—Å—Ç—å} –æ—Ö–ª–∞–∂–¥–µ–Ω–Ω–∞—è',
        '–ò–Ω–¥–µ–π–∫–∞ {—á–∞—Å—Ç—å} –¥–∏–µ—Ç–∏—á–µ—Å–∫–∞—è',
        '–ë–∞—Ä–∞–Ω–∏–Ω–∞ {—á–∞—Å—Ç—å} –º–æ–ª–æ–¥–∞—è'
    ],
    '–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã': [
        '–ú–æ–ª–æ–∫–æ {–∂–∏—Ä–Ω–æ—Å—Ç—å}% —Ñ–µ—Ä–º–µ—Ä—Å–∫–æ–µ',
        '–¢–≤–æ—Ä–æ–≥ {–∂–∏—Ä–Ω–æ—Å—Ç—å}% –¥–æ–º–∞—à–Ω–∏–π',
        '–°–º–µ—Ç–∞–Ω–∞ {–∂–∏—Ä–Ω–æ—Å—Ç—å}% –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è',
        '–°—ã—Ä {—Å–æ—Ä—Ç} —Ñ–µ—Ä–º–µ—Ä—Å–∫–∏–π',
        '–ú–∞—Å–ª–æ —Å–ª–∏–≤–æ—á–Ω–æ–µ {–∂–∏—Ä–Ω–æ—Å—Ç—å}%',
        '–ö–µ—Ñ–∏—Ä {–∂–∏—Ä–Ω–æ—Å—Ç—å}% —Å–≤–µ–∂–∏–π'
    ],
    '–Ø–π—Ü–∞': [
        '–Ø–π—Ü–∞ –∫—É—Ä–∏–Ω—ã–µ {–∫–∞—Ç–µ–≥–æ—Ä–∏—è} {–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ} —à—Ç',
        '–Ø–π—Ü–∞ –ø–µ—Ä–µ–ø–µ–ª–∏–Ω—ã–µ —Å–≤–µ–∂–∏–µ',
        '–Ø–π—Ü–∞ —É—Ç–∏–Ω—ã–µ –¥–æ–º–∞—à–Ω–∏–µ'
    ],
    '–ú—ë–¥': [
        '–ú—ë–¥ {—Å–æ—Ä—Ç} –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π',
        '–ú—ë–¥ {—Å–æ—Ä—Ç} —Ü–≤–µ—Ç–æ—á–Ω—ã–π',
        '–ú—ë–¥ {—Å–æ—Ä—Ç} –ª—É–≥–æ–≤–æ–π'
    ],
    '–ö—Ä—É–ø—ã': [
        '–ì—Ä–µ—á–∫–∞ {—Å–æ—Ä—Ç} {—Ä–∞–∑–º–µ—Ä}',
        '–†–∏—Å {—Å–æ—Ä—Ç} {—Ä–∞–∑–º–µ—Ä}',
        '–ü—à–µ–Ω–æ {—Å–æ—Ä—Ç} —à–ª–∏—Ñ–æ–≤–∞–Ω–Ω–æ–µ',
        '–û–≤—Å—è–Ω–∫–∞ {—Å–æ—Ä—Ç} —Ü–µ–ª—å–Ω–∞—è',
        '–ü–µ—Ä–ª–æ–≤–∫–∞ {—Å–æ—Ä—Ç} –æ—Ç–±–æ—Ä–Ω–∞—è'
    ],
    '–ö–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏—è': [
        '–û–≥—É—Ä—Ü—ã –º–∞—Ä–∏–Ω–æ–≤–∞–Ω–Ω—ã–µ {—Ä–∞–∑–º–µ—Ä}',
        '–ü–æ–º–∏–¥–æ—Ä—ã –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ',
        '–í–∞—Ä–µ–Ω—å–µ {–≤–∫—É—Å} –¥–æ–º–∞—à–Ω–µ–µ',
        '–ö–æ–º–ø–æ—Ç {–≤–∫—É—Å} –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π',
        '–°–æ–ª–µ–Ω—å—è –∞—Å—Å–æ—Ä—Ç–∏'
    ]
}

# –í–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
variants = {
    '—Å–æ—Ä—Ç': ['–î–æ–º–∞—à–Ω–∏–π', '–§–µ—Ä–º–µ—Ä—Å–∫–∏–π', '–û—Ç–±–æ—Ä–Ω—ã–π', '–≠–ª–∏—Ç–Ω—ã–π', '–ü—Ä–µ–º–∏—É–º', '–≠–∫–æ'],
    '—Ä–∞–∑–º–µ—Ä': ['–∫—Ä—É–ø–Ω—ã–π', '—Å—Ä–µ–¥–Ω–∏–π', '–º–µ–ª–∫–∏–π', '–æ—Ç–±–æ—Ä–Ω—ã–π'],
    '—Ü–≤–µ—Ç': ['–∫—Ä–∞—Å–Ω—ã–π', '–∂–µ–ª—Ç—ã–π', '–∑–µ–ª–µ–Ω—ã–π', '–±–µ–ª—ã–π'],
    '–∂–∏—Ä–Ω–æ—Å—Ç—å': ['2.5', '3.2', '5', '9', '15', '20'],
    '—á–∞—Å—Ç—å': ['–≤—ã—Ä–µ–∑–∫–∞', '–≥—Ä—É–¥–∫–∞', '–æ–∫–æ—Ä–æ–∫', '—Ñ–∏–ª–µ', '—Ä–µ–±—Ä–∞'],
    '–∫–∞—Ç–µ–≥–æ—Ä–∏—è': ['–°0', '–°1', '–°2'],
    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ': ['10', '20', '30'],
    '–≤–∫—É—Å': ['–∫–ª—É–±–Ω–∏—á–Ω–æ–µ', '–º–∞–ª–∏–Ω–æ–≤–æ–µ', '–≤–∏—à–Ω–µ–≤–æ–µ', '—è–±–ª–æ—á–Ω–æ–µ', '–≥—Ä—É—à–µ–≤–æ–µ']
}

# –û–ø–∏—Å–∞–Ω–∏—è
descriptions = [
    '–°–≤–µ–∂–∏–π –ø—Ä–æ–¥—É–∫—Ç —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞. –í—ã—Ä–∞—â–µ–Ω–æ –±–µ–∑ —Ö–∏–º–∏–∏.',
    '–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç –æ—Ç —Ñ–µ—Ä–º–µ—Ä–∞. –≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–π.',
    '–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–æ–≤–∞—Ä. –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –≥–æ—Ä–æ–¥—É.',
    '–°–≤–µ–∂–∏–π —É—Ä–æ–∂–∞–π. –í–æ–∑–º–æ–∂–µ–Ω —Å–∞–º–æ–≤—ã–≤–æ–∑.',
    '–î–æ–º–∞—à–Ω–∏–π –ø—Ä–æ–¥—É–∫—Ç. –ë–µ–∑ –∫–æ–Ω—Å–µ—Ä–≤–∞–Ω—Ç–æ–≤ –∏ –¥–æ–±–∞–≤–æ–∫.',
    '–§–µ—Ä–º–µ—Ä—Å–∫–∏–π –ø—Ä–æ–¥—É–∫—Ç –≤—ã—Å—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.',
    '–°–≤–µ–∂–∏–π —Ç–æ–≤–∞—Ä –Ω–∞–ø—Ä—è–º—É—é –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è.',
    '–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç. –û–ø—Ç–æ–º –¥–µ—à–µ–≤–ª–µ.'
]

total_inserted = 0

for cat_id, cat_name in categories:
    print(f"üì¶ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {cat_name} (ID: {cat_id})")
    
    # –í—ã–±–∏—Ä–∞–µ–º —à–∞–±–ª–æ–Ω—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    templates = []
    for key in product_templates:
        if key.lower() in cat_name.lower():
            templates = product_templates[key]
            break
    
    if not templates:
        templates = ['–¢–æ–≤–∞—Ä {—Å–æ—Ä—Ç} {—Ä–∞–∑–º–µ—Ä}']
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 100 —Ç–æ–≤–∞—Ä–æ–≤
    for i in range(100):
        # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —à–∞–±–ª–æ–Ω
        template = random.choice(templates)
        
        # –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
        name = template
        for key, values in variants.items():
            if f'{{{key}}}' in name:
                name = name.replace(f'{{{key}}}', random.choice(values))
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ü–µ–Ω—É
        price = round(random.uniform(50, 5000), 2)
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        description = random.choice(descriptions)
        
        # –†–µ–π—Ç–∏–Ω–≥
        rating = round(random.uniform(3.5, 5.0), 1)
        reviews_count = random.randint(0, 50)
        
        # –ù–∞–ª–∏—á–∏–µ
        in_stock = random.choice([True, True, True, False])  # 75% –≤ –Ω–∞–ª–∏—á–∏–∏
        
        # –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
        unit = random.choice(['–∫–≥', '—à—Ç', '–ª', '—É–ø–∞–∫', '–ø—É—á–æ–∫'])
        
        # –í—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä
        try:
            cur.execute("""
                INSERT INTO market.products 
                (name, description, price, category_id, rating, reviews_count, in_stock, unit)
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s)
            """, (name, description, price, cat_id, rating, reviews_count, in_stock, unit))
            
            total_inserted += 1
            
        except Exception as e:
            print(f"  ‚ùå –û—à–∏–±–∫–∞: {e}")
            continue
    
    print(f"  ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: 100 —Ç–æ–≤–∞—Ä–æ–≤\n")

conn.commit()

print(f"\nüéâ –í—Å–µ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: {total_inserted}")
print(f"üìä –ö–∞—Ç–µ–≥–æ—Ä–∏–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {len(categories)}")

cur.close()
conn.close()
