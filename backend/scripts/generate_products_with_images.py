"""
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
–ü–æ 100 —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é
"""
import psycopg2
import random
import requests
import os
from pathlib import Path

conn = psycopg2.connect(
    host="localhost",
    port=5432,
    database="edu_na_bazar",
    user="postgres",
    password="postgres"
)

cur = conn.cursor()

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
IMAGES_DIR = Path(r"C:\python\edu-na-bazar\backend\uploads\products\original")
IMAGES_DIR.mkdir(parents=True, exist_ok=True)

# –ü–æ–ª—É—á–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
cur.execute("SELECT id, name FROM market.categories ORDER BY id")
categories = cur.fetchall()

print(f"üìä –ù–∞–π–¥–µ–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {len(categories)}\n")

# –®–∞–±–ª–æ–Ω—ã —Ç–æ–≤–∞—Ä–æ–≤ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ –æ–ø–∏—Å–∞–Ω–∏—è–º–∏
PRODUCTS_DATA = {
    '–û–≤–æ—â–∏': [
        {
            'names': ['–ü–æ–º–∏–¥–æ—Ä—ã —á–µ—Ä—Ä–∏', '–ü–æ–º–∏–¥–æ—Ä—ã —Å–ª–∏–≤–∫–∞', '–ü–æ–º–∏–¥–æ—Ä—ã –±—ã—á—å–µ —Å–µ—Ä–¥—Ü–µ', '–ü–æ–º–∏–¥–æ—Ä—ã —Ä–æ–∑–æ–≤—ã–µ'],
            'descriptions': [
                '–°–≤–µ–∂–∏–µ –ø–æ–º–∏–¥–æ—Ä—ã —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Ç–µ–ø–ª–∏—Ü—ã. –í—ã—Ä–∞—â–µ–Ω—ã –±–µ–∑ —Ö–∏–º–∏–∫–∞—Ç–æ–≤. –°–ª–∞–¥–∫–∏–µ –∏ —Å–æ—á–Ω—ã–µ.',
                '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–µ —Ç–æ–º–∞—Ç—ã. –ò–¥–µ–∞–ª—å–Ω—ã –¥–ª—è —Å–∞–ª–∞—Ç–æ–≤ –∏ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏.',
                '–°–ø–µ–ª—ã–µ –ø–æ–º–∏–¥–æ—Ä—ã –ø—Ä—è–º–æ —Å –≥—Ä—è–¥–∫–∏. –ù–∞—Å—ã—â–µ–Ω–Ω—ã–π –≤–∫—É—Å –∏ –∞—Ä–æ–º–∞—Ç.'
            ],
            'price_range': (80, 250),
            'unit': '–∫–≥',
            'search_terms': ['tomato', 'tomatoes']
        },
        {
            'names': ['–û–≥—É—Ä—Ü—ã –≥—Ä—É–Ω—Ç–æ–≤—ã–µ', '–û–≥—É—Ä—Ü—ã —Ç–µ–ø–ª–∏—á–Ω—ã–µ', '–û–≥—É—Ä—Ü—ã –∫–æ—Ä–Ω–∏—à–æ–Ω—ã'],
            'descriptions': [
                '–•—Ä—É—Å—Ç—è—â–∏–µ –æ–≥—É—Ä—Ü—ã –±–µ–∑ –≥–æ—Ä–µ—á–∏. –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∑–∞—Å–æ–ª–∫–∏.',
                '–°–≤–µ–∂–∏–µ –æ–≥—É—Ä—Ü—ã —Å —Ñ–µ—Ä–º—ã. –í—ã—Ä–∞—â–µ–Ω—ã –≤ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.',
                '–ê—Ä–æ–º–∞—Ç–Ω—ã–µ –æ–≥—É—Ä—Ü—ã. –ò–¥–µ–∞–ª—å–Ω—ã –¥–ª—è —Å–≤–µ–∂–∏—Ö —Å–∞–ª–∞—Ç–æ–≤.'
            ],
            'price_range': (60, 180),
            'unit': '–∫–≥',
            'search_terms': ['cucumber', 'cucumbers']
        },
        {
            'names': ['–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –º–æ–ª–æ–¥–æ–π', '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –∫—Ä–∞—Å–Ω—ã–π', '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –±–µ–ª—ã–π'],
            'descriptions': [
                '–û—Ç–±–æ—Ä–Ω—ã–π –∫–∞—Ä—Ç–æ—Ñ–µ–ª—å —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—è. –†–∞—Å—Å—ã–ø—á–∞—Ç—ã–π, –≤–∫—É—Å–Ω—ã–π.',
                '–°–≤–µ–∂–∏–π —É—Ä–æ–∂–∞–π –∫–∞—Ä—Ç–æ—Ñ–µ–ª—è. –û—Ç–ª–∏—á–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è, –Ω–µ –ø—Ä–æ—Ä–∞—Å—Ç–∞–µ—Ç.',
                '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å –≤—ã—Å—à–µ–≥–æ —Å–æ—Ä—Ç–∞. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ª—é–±—ã—Ö –±–ª—é–¥.'
            ],
            'price_range': (30, 80),
            'unit': '–∫–≥',
            'search_terms': ['potato', 'potatoes']
        },
        {
            'names': ['–ú–æ—Ä–∫–æ–≤—å —Å–æ—á–Ω–∞—è', '–ú–æ—Ä–∫–æ–≤—å –∫—Ä—É–ø–Ω–∞—è', '–ú–æ—Ä–∫–æ–≤—å —Å–ª–∞–¥–∫–∞—è'],
            'descriptions': [
                '–°–ª–∞–¥–∫–∞—è –º–æ—Ä–∫–æ–≤—å —è—Ä–∫–æ-–æ—Ä–∞–Ω–∂–µ–≤–æ–≥–æ —Ü–≤–µ—Ç–∞. –ë–æ–≥–∞—Ç–∞ –≤–∏—Ç–∞–º–∏–Ω–∞–º–∏.',
                '–°–æ—á–Ω–∞—è –º–æ—Ä–∫–æ–≤—å –±–µ–∑ –Ω–∏—Ç—Ä–∞—Ç–æ–≤. –û—Ç–ª–∏—á–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤—Å—é –∑–∏–º—É.',
                '–ö—Ä—É–ø–Ω–∞—è –º–æ—Ä–∫–æ–≤—å –¥–ª—è —Å–æ–∫–æ–≤ –∏ —Å–∞–ª–∞—Ç–æ–≤. –û—á–µ–Ω—å —Å–ª–∞–¥–∫–∞—è.'
            ],
            'price_range': (40, 100),
            'unit': '–∫–≥',
            'search_terms': ['carrot', 'carrots']
        },
        {
            'names': ['–ö–∞–ø—É—Å—Ç–∞ –±–µ–ª–æ–∫–æ—á–∞–Ω–Ω–∞—è', '–ö–∞–ø—É—Å—Ç–∞ –∫—Ä–∞—Å–Ω–æ–∫–æ—á–∞–Ω–Ω–∞—è', '–ö–∞–ø—É—Å—Ç–∞ –ø–µ–∫–∏–Ω—Å–∫–∞—è'],
            'descriptions': [
                '–°–≤–µ–∂–∞—è –∫–∞–ø—É—Å—Ç–∞ —Å —Ö—Ä—É—Å—Ç—è—â–∏–º–∏ –ª–∏—Å—Ç—å—è–º–∏. –ò–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è –∫–≤–∞—à–µ–Ω–∏—è.',
                '–ü–ª–æ—Ç–Ω—ã–µ –∫–æ—á–∞–Ω—ã –∫–∞–ø—É—Å—Ç—ã. –î–æ–ª–≥–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è, –Ω–µ –ø–æ—Ä—Ç–∏—Ç—Å—è.',
                '–°–æ—á–Ω–∞—è –∫–∞–ø—É—Å—Ç–∞ –¥–ª—è —Å–∞–ª–∞—Ç–æ–≤ –∏ –±–æ—Ä—â–∞. –ë–µ–∑ —Ö–∏–º–∏–∏.'
            ],
            'price_range': (25, 70),
            'unit': '–∫–≥',
            'search_terms': ['cabbage']
        },
        {
            'names': ['–°–≤–µ–∫–ª–∞ —Å—Ç–æ–ª–æ–≤–∞—è', '–°–≤–µ–∫–ª–∞ –±–æ—Ä–¥–æ', '–°–≤–µ–∫–ª–∞ —Ü–∏–ª–∏–Ω–¥—Ä–∞'],
            'descriptions': [
                '–°–ª–∞–¥–∫–∞—è —Å–≤–µ–∫–ª–∞ –Ω–∞—Å—ã—â–µ–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞. –û—Ç–ª–∏—á–Ω–æ –≤–∞—Ä–∏—Ç—Å—è.',
                '–°–æ—á–Ω–∞—è —Å–≤–µ–∫–ª–∞ –¥–ª—è –±–æ—Ä—â–∞ –∏ —Å–∞–ª–∞—Ç–æ–≤. –ë–µ–∑ –ø—Ä–æ–∂–∏–ª–æ–∫.',
                '–ö—Ä—É–ø–Ω–∞—è —Å–≤–µ–∫–ª–∞ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –æ–≥–æ—Ä–æ–¥–∞. –û—á–µ–Ω—å –≤–∫—É—Å–Ω–∞—è.'
            ],
            'price_range': (35, 90),
            'unit': '–∫–≥',
            'search_terms': ['beet', 'beetroot']
        },
        {
            'names': ['–õ—É–∫ —Ä–µ–ø—á–∞—Ç—ã–π', '–õ—É–∫ –∫—Ä–∞—Å–Ω—ã–π', '–õ—É–∫ –±–µ–ª—ã–π'],
            'descriptions': [
                '–û—Å—Ç—Ä—ã–π –ª—É–∫ –∑–æ–ª–æ—Ç–∏—Å—Ç–æ–≥–æ —Ü–≤–µ—Ç–∞. –î–æ–ª–≥–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è.',
                '–°–ª–∞–¥–∫–∏–π –ª—É–∫ –¥–ª—è —Å–∞–ª–∞—Ç–æ–≤. –ù–µ –≥–æ—Ä—á–∏—Ç, —Å–æ—á–Ω—ã–π.',
                '–ö—Ä—É–ø–Ω—ã–π –ª—É–∫ –æ—Ç–±–æ—Ä–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞. –ë–µ–∑ –≥–Ω–∏–ª–∏.'
            ],
            'price_range': (30, 80),
            'unit': '–∫–≥',
            'search_terms': ['onion', 'onions']
        },
        {
            'names': ['–ü–µ—Ä–µ—Ü –±–æ–ª–≥–∞—Ä—Å–∫–∏–π –∫—Ä–∞—Å–Ω—ã–π', '–ü–µ—Ä–µ—Ü –∂–µ–ª—Ç—ã–π', '–ü–µ—Ä–µ—Ü –∑–µ–ª–µ–Ω—ã–π'],
            'descriptions': [
                '–°–ª–∞–¥–∫–∏–π –ø–µ—Ä–µ—Ü —Å —Ç–æ–ª—Å—Ç—ã–º–∏ —Å—Ç–µ–Ω–∫–∞–º–∏. –û—á–µ–Ω—å —Å–æ—á–Ω—ã–π.',
                '–ê—Ä–æ–º–∞—Ç–Ω—ã–π –ø–µ—Ä–µ—Ü –¥–ª—è —Å–∞–ª–∞—Ç–æ–≤ –∏ —Ñ–∞—Ä—à–∏—Ä–æ–≤–∞–Ω–∏—è.',
                '–•—Ä—É—Å—Ç—è—â–∏–π –ø–µ—Ä–µ—Ü —è—Ä–∫–∏—Ö —Ü–≤–µ—Ç–æ–≤. –ë–æ–≥–∞—Ç –≤–∏—Ç–∞–º–∏–Ω–∞–º–∏.'
            ],
            'price_range': (150, 350),
            'unit': '–∫–≥',
            'search_terms': ['bell pepper', 'pepper']
        }
    ],
    '–§—Ä—É–∫—Ç—ã': [
        {
            'names': ['–Ø–±–ª–æ–∫–∏ –∞–Ω—Ç–æ–Ω–æ–≤–∫–∞', '–Ø–±–ª–æ–∫–∏ —Å–µ–º–µ—Ä–µ–Ω–∫–æ', '–Ø–±–ª–æ–∫–∏ –≥–æ–ª–¥–µ–Ω'],
            'descriptions': [
                '–°–æ—á–Ω—ã–µ —è–±–ª–æ–∫–∏ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–∞–¥–∞. –ö–∏—Å–ª–æ-—Å–ª–∞–¥–∫–∏–µ, –∞—Ä–æ–º–∞—Ç–Ω—ã–µ.',
                '–•—Ä—É—Å—Ç—è—â–∏–µ —è–±–ª–æ–∫–∏ –±–µ–∑ —Ö–∏–º–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏. –î–æ–ª–≥–æ —Ö—Ä–∞–Ω—è—Ç—Å—è.',
                '–°–ø–µ–ª—ã–µ —è–±–ª–æ–∫–∏ –¥–ª—è —Å–æ–∫–æ–≤ –∏ –∫–æ–º–ø–æ—Ç–æ–≤. –û—á–µ–Ω—å –≤–∫—É—Å–Ω—ã–µ.'
            ],
            'price_range': (60, 180),
            'unit': '–∫–≥',
            'search_terms': ['apple', 'apples']
        },
        {
            'names': ['–ì—Ä—É—à–∏ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏—è', '–ì—Ä—É—à–∏ –¥—é—à–µ—Å', '–ì—Ä—É—à–∏ –≤–∏–ª—å—è–º—Å'],
            'descriptions': [
                '–°–ª–∞–¥–∫–∏–µ –≥—Ä—É—à–∏ —Å –Ω–µ–∂–Ω–æ–π –º—è–∫–æ—Ç—å—é. –¢–∞—é—Ç –≤–æ —Ä—Ç—É.',
                '–ê—Ä–æ–º–∞—Ç–Ω—ã–µ –≥—Ä—É—à–∏ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–∞–¥–∞. –ë–µ–∑ —á–µ—Ä–≤–æ—Ç–æ—á–∏–Ω.',
                '–°–æ—á–Ω—ã–µ –≥—Ä—É—à–∏ –¥–ª—è –¥–µ—Å–µ—Ä—Ç–æ–≤. –û—á–µ–Ω—å —Å–ª–∞–¥–∫–∏–µ.'
            ],
            'price_range': (80, 200),
            'unit': '–∫–≥',
            'search_terms': ['pear', 'pears']
        },
        {
            'names': ['–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–∏—à–º–∏—à', '–í–∏–Ω–æ–≥—Ä–∞–¥ –∏–∑–∞–±–µ–ª–ª–∞', '–í–∏–Ω–æ–≥—Ä–∞–¥ –º–æ–ª–¥–æ–≤–∞'],
            'descriptions': [
                '–°–ª–∞–¥–∫–∏–π –≤–∏–Ω–æ–≥—Ä–∞–¥ –±–µ–∑ –∫–æ—Å—Ç–æ—á–µ–∫. –ö—Ä—É–ø–Ω—ã–µ —è–≥–æ–¥—ã.',
                '–ê—Ä–æ–º–∞—Ç–Ω—ã–π –≤–∏–Ω–æ–≥—Ä–∞–¥ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–∏–Ω–æ–≥—Ä–∞–¥–Ω–∏–∫–∞.',
                '–°–æ—á–Ω—ã–π –≤–∏–Ω–æ–≥—Ä–∞–¥ –¥–ª—è –µ–¥—ã –∏ –≤–∏–Ω–∞. –°–ø–µ–ª—ã–π, —Å–ª–∞–¥–∫–∏–π.'
            ],
            'price_range': (120, 300),
            'unit': '–∫–≥',
            'search_terms': ['grape', 'grapes']
        },
        {
            'names': ['–ê—Ä–±—É–∑ –∞—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∏–π', '–ê—Ä–±—É–∑ –∫—Ä—ã–º—Å–∫–∏–π', '–ê—Ä–±—É–∑ —Ö–µ—Ä—Å–æ–Ω—Å–∫–∏–π'],
            'descriptions': [
                '–°–ª–∞–¥–∫–∏–π –∞—Ä–±—É–∑ —Å –∫—Ä–∞—Å–Ω–æ–π –º—è–∫–æ—Ç—å—é. –û—á–µ–Ω—å —Å–æ—á–Ω—ã–π.',
                '–°–ø–µ–ª—ã–π –∞—Ä–±—É–∑ –ø—Ä—è–º–æ —Å –±–∞—Ö—á–∏. –°–∞—Ö–∞—Ä–Ω—ã–π, –∞—Ä–æ–º–∞—Ç–Ω—ã–π.',
                '–ö—Ä—É–ø–Ω—ã–π –∞—Ä–±—É–∑ –±–µ–∑ –Ω–∏—Ç—Ä–∞—Ç–æ–≤. –ì–∞—Ä–∞–Ω—Ç–∏—è —Å–ª–∞–¥–æ—Å—Ç–∏.'
            ],
            'price_range': (20, 50),
            'unit': '–∫–≥',
            'search_terms': ['watermelon']
        }
    ],
    '–Ø–≥–æ–¥—ã': [
        {
            'names': ['–ö–ª—É–±–Ω–∏–∫–∞ —Å–∞–¥–æ–≤–∞—è', '–ö–ª—É–±–Ω–∏–∫–∞ –≤–∏–∫—Ç–æ—Ä–∏—è', '–ö–ª—É–±–Ω–∏–∫–∞ –∞–ª—å–±–∏–æ–Ω'],
            'descriptions': [
                '–ö—Ä—É–ø–Ω–∞—è –∫–ª—É–±–Ω–∏–∫–∞ —Å –∞—Ä–æ–º–∞—Ç–æ–º –ª–µ—Ç–∞. –û—á–µ–Ω—å —Å–ª–∞–¥–∫–∞—è.',
                '–°–≤–µ–∂–∞—è –∫–ª—É–±–Ω–∏–∫–∞ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –≥—Ä—è–¥–∫–∏. –ë–µ–∑ —Ö–∏–º–∏–∏.',
                '–°–æ—á–Ω–∞—è –∫–ª—É–±–Ω–∏–∫–∞ –¥–ª—è –≤–∞—Ä–µ–Ω—å—è –∏ –¥–µ—Å–µ—Ä—Ç–æ–≤.'
            ],
            'price_range': (200, 500),
            'unit': '–∫–≥',
            'search_terms': ['strawberry', 'strawberries']
        },
        {
            'names': ['–ú–∞–ª–∏–Ω–∞ –∫—Ä–∞—Å–Ω–∞—è', '–ú–∞–ª–∏–Ω–∞ –∂–µ–ª—Ç–∞—è', '–ú–∞–ª–∏–Ω–∞ —Ä–µ–º–æ–Ω—Ç–∞–Ω—Ç–Ω–∞—è'],
            'descriptions': [
                '–ê—Ä–æ–º–∞—Ç–Ω–∞—è –º–∞–ª–∏–Ω–∞ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–∞–¥–∞. –°–ª–∞–¥–∫–∞—è, –∫—Ä—É–ø–Ω–∞—è.',
                '–°–≤–µ–∂–∞—è –º–∞–ª–∏–Ω–∞ –¥–ª—è –≤–∞—Ä–µ–Ω—å—è. –ë–µ–∑ —á–µ—Ä–≤—è—á–∫–æ–≤.',
                '–°–æ—á–Ω–∞—è –º–∞–ª–∏–Ω–∞ –ø—Ä—è–º–æ —Å –∫—É—Å—Ç–∞. –û—á–µ–Ω—å –≤–∫—É—Å–Ω–∞—è.'
            ],
            'price_range': (250, 600),
            'unit': '–∫–≥',
            'search_terms': ['raspberry', 'raspberries']
        },
        {
            'names': ['–°–º–æ—Ä–æ–¥–∏–Ω–∞ —á–µ—Ä–Ω–∞—è', '–°–º–æ—Ä–æ–¥–∏–Ω–∞ –∫—Ä–∞—Å–Ω–∞—è', '–°–º–æ—Ä–æ–¥–∏–Ω–∞ –±–µ–ª–∞—è'],
            'descriptions': [
                '–ö—Ä—É–ø–Ω–∞—è —Å–º–æ—Ä–æ–¥–∏–Ω–∞ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–∞–¥–∞. –ö–∏—Å–ª–æ-—Å–ª–∞–¥–∫–∞—è.',
                '–°–ø–µ–ª–∞—è —Å–º–æ—Ä–æ–¥–∏–Ω–∞ –¥–ª—è –∫–æ–º–ø–æ—Ç–æ–≤ –∏ –≤–∞—Ä–µ–Ω—å—è.',
                '–°–æ—á–Ω–∞—è —Å–º–æ—Ä–æ–¥–∏–Ω–∞ –±–æ–≥–∞—Ç–∞ –≤–∏—Ç–∞–º–∏–Ω–∞–º–∏. –û—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–∞—è.'
            ],
            'price_range': (150, 400),
            'unit': '–∫–≥',
            'search_terms': ['currant', 'currants']
        }
    ],
    '–ó–µ–ª–µ–Ω—å': [
        {
            'names': ['–£–∫—Ä–æ–ø —Å–≤–µ–∂–∏–π', '–£–∫—Ä–æ–ø –ø—É—á–∫–æ–≤–æ–π', '–£–∫—Ä–æ–ø –∞—Ä–æ–º–∞—Ç–Ω—ã–π'],
            'descriptions': [
                '–°–≤–µ–∂–∏–π —É–∫—Ä–æ–ø —Å –≥—Ä—è–¥–∫–∏. –û—á–µ–Ω—å –∞—Ä–æ–º–∞—Ç–Ω—ã–π.',
                '–°–æ—á–Ω—ã–π —É–∫—Ä–æ–ø –¥–ª—è —Å–∞–ª–∞—Ç–æ–≤ –∏ –∑–∞—Å–æ–ª–∫–∏.',
                '–ó–µ–ª–µ–Ω—ã–π —É–∫—Ä–æ–ø –±–µ–∑ –∂–µ–ª—Ç–∏–∑–Ω—ã. –ö—Ä—É–ø–Ω—ã–µ –ø—É—á–∫–∏.'
            ],
            'price_range': (30, 80),
            'unit': '–ø—É—á–æ–∫',
            'search_terms': ['dill']
        },
        {
            'names': ['–ü–µ—Ç—Ä—É—à–∫–∞ –∫—É–¥—Ä—è–≤–∞—è', '–ü–µ—Ç—Ä—É—à–∫–∞ –ª–∏—Å—Ç–æ–≤–∞—è', '–ü–µ—Ç—Ä—É—à–∫–∞ –∫–æ—Ä–Ω–µ–≤–∞—è'],
            'descriptions': [
                '–ê—Ä–æ–º–∞—Ç–Ω–∞—è –ø–µ—Ç—Ä—É—à–∫–∞ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –≥—Ä—è–¥–∫–∏.',
                '–°–≤–µ–∂–∞—è –ø–µ—Ç—Ä—É—à–∫–∞ –¥–ª—è —Å–∞–ª–∞—Ç–æ–≤ –∏ —Å—É–ø–æ–≤.',
                '–°–æ—á–Ω–∞—è –ø–µ—Ç—Ä—É—à–∫–∞ –±–æ–≥–∞—Ç–∞ –≤–∏—Ç–∞–º–∏–Ω–∞–º–∏.'
            ],
            'price_range': (30, 80),
            'unit': '–ø—É—á–æ–∫',
            'search_terms': ['parsley']
        },
        {
            'names': ['–°–∞–ª–∞—Ç –∞–π—Å–±–µ—Ä–≥', '–°–∞–ª–∞—Ç —Ä–æ–º–∞–Ω–æ', '–°–∞–ª–∞—Ç —Ä—É–∫–∫–æ–ª–∞'],
            'descriptions': [
                '–•—Ä—É—Å—Ç—è—â–∏–π —Å–∞–ª–∞—Ç —Å –Ω–µ–∂–Ω—ã–º–∏ –ª–∏—Å—Ç—å—è–º–∏.',
                '–°–≤–µ–∂–∏–π —Å–∞–ª–∞—Ç –¥–ª—è –≤–∏—Ç–∞–º–∏–Ω–Ω—ã—Ö —Å–∞–ª–∞—Ç–æ–≤.',
                '–°–æ—á–Ω—ã–π —Å–∞–ª–∞—Ç –±–µ–∑ –≥–æ—Ä–µ—á–∏. –û—á–µ–Ω—å –≤–∫—É—Å–Ω—ã–π.'
            ],
            'price_range': (50, 150),
            'unit': '—à—Ç',
            'search_terms': ['lettuce', 'salad']
        }
    ],
    '–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã': [
        {
            'names': ['–ú–æ–ª–æ–∫–æ –∫–æ—Ä–æ–≤—å–µ 3.2%', '–ú–æ–ª–æ–∫–æ –∫–æ–∑—å–µ', '–ú–æ–ª–æ–∫–æ —Ç–æ–ø–ª–µ–Ω–æ–µ'],
            'descriptions': [
                '–°–≤–µ–∂–µ–µ —Ñ–µ—Ä–º–µ—Ä—Å–∫–æ–µ –º–æ–ª–æ–∫–æ. –ù–∞—Ç—É—Ä–∞–ª—å–Ω–æ–µ, –±–µ–∑ –¥–æ–±–∞–≤–æ–∫.',
                '–ü–∞—Ä–Ω–æ–µ –º–æ–ª–æ–∫–æ –æ—Ç –∑–¥–æ—Ä–æ–≤—ã—Ö –∫–æ—Ä–æ–≤. –ñ–∏—Ä–Ω–æ–µ, –≤–∫—É—Å–Ω–æ–µ.',
                '–î–æ–º–∞—à–Ω–µ–µ –º–æ–ª–æ–∫–æ –≤—ã—Å—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞. –û—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–æ–µ.'
            ],
            'price_range': (60, 120),
            'unit': '–ª',
            'search_terms': ['milk']
        },
        {
            'names': ['–¢–≤–æ—Ä–æ–≥ –¥–æ–º–∞—à–Ω–∏–π 9%', '–¢–≤–æ—Ä–æ–≥ –æ–±–µ–∑–∂–∏—Ä–µ–Ω–Ω—ã–π', '–¢–≤–æ—Ä–æ–≥ –∑–µ—Ä–Ω–µ–Ω—ã–π'],
            'descriptions': [
                '–°–≤–µ–∂–∏–π —Ç–≤–æ—Ä–æ–≥ –∏–∑ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–≥–æ –º–æ–ª–æ–∫–∞. –ë–µ–∑ –∫–æ–Ω—Å–µ—Ä–≤–∞–Ω—Ç–æ–≤.',
                '–î–æ–º–∞—à–Ω–∏–π —Ç–≤–æ—Ä–æ–≥ –Ω–µ–∂–Ω–æ–π –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ü–∏–∏. –û—á–µ–Ω—å –≤–∫—É—Å–Ω—ã–π.',
                '–§–µ—Ä–º–µ—Ä—Å–∫–∏–π —Ç–≤–æ—Ä–æ–≥ –≤—ã—Å—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞. –ë–æ–≥–∞—Ç –∫–∞–ª—å—Ü–∏–µ–º.'
            ],
            'price_range': (150, 350),
            'unit': '–∫–≥',
            'search_terms': ['cottage cheese', 'curd']
        },
        {
            'names': ['–°–º–µ—Ç–∞–Ω–∞ 20%', '–°–º–µ—Ç–∞–Ω–∞ 15%', '–°–º–µ—Ç–∞–Ω–∞ –¥–æ–º–∞—à–Ω—è—è'],
            'descriptions': [
                '–ì—É—Å—Ç–∞—è —Å–º–µ—Ç–∞–Ω–∞ –∏–∑ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö —Å–ª–∏–≤–æ–∫.',
                '–î–æ–º–∞—à–Ω—è—è —Å–º–µ—Ç–∞–Ω–∞ –±–µ–∑ –∑–∞–≥—É—Å—Ç–∏—Ç–µ–ª–µ–π. –û—á–µ–Ω—å –≤–∫—É—Å–Ω–∞—è.',
                '–§–µ—Ä–º–µ—Ä—Å–∫–∞—è —Å–º–µ—Ç–∞–Ω–∞ –≤—ã—Å–æ–∫–æ–π –∂–∏—Ä–Ω–æ—Å—Ç–∏.'
            ],
            'price_range': (120, 280),
            'unit': '–∫–≥',
            'search_terms': ['sour cream']
        }
    ],
    '–Ø–π—Ü–∞': [
        {
            'names': ['–Ø–π—Ü–∞ –∫—É—Ä–∏–Ω—ã–µ –°0', '–Ø–π—Ü–∞ –∫—É—Ä–∏–Ω—ã–µ –°1', '–Ø–π—Ü–∞ –¥–æ–º–∞—à–Ω–∏–µ'],
            'descriptions': [
                '–°–≤–µ–∂–∏–µ —è–π—Ü–∞ –æ—Ç –¥–æ–º–∞—à–Ω–∏—Ö –∫—É—Ä. –ö—Ä—É–ø–Ω—ã–µ, —Å —è—Ä–∫–∏–º –∂–µ–ª—Ç–∫–æ–º.',
                '–§–µ—Ä–º–µ—Ä—Å–∫–∏–µ —è–π—Ü–∞ –≤—ã—Å—à–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –û—á–µ–Ω—å –≤–∫—É—Å–Ω—ã–µ.',
                '–î–µ—Ä–µ–≤–µ–Ω—Å–∫–∏–µ —è–π—Ü–∞ –æ—Ç –∫—É—Ä —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—ã–≥—É–ª–∞.'
            ],
            'price_range': (80, 150),
            'unit': '10 —à—Ç',
            'search_terms': ['eggs', 'chicken eggs']
        },
        {
            'names': ['–Ø–π—Ü–∞ –ø–µ—Ä–µ–ø–µ–ª–∏–Ω—ã–µ', '–Ø–π—Ü–∞ –ø–µ—Ä–µ–ø–µ–ª–∏–Ω—ã–µ –¥–∏–µ—Ç–∏—á–µ—Å–∫–∏–µ'],
            'descriptions': [
                '–°–≤–µ–∂–∏–µ –ø–µ—Ä–µ–ø–µ–ª–∏–Ω—ã–µ —è–π—Ü–∞. –û—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã–µ.',
                '–î–∏–µ—Ç–∏—á–µ—Å–∫–∏–µ —è–π—Ü–∞ –ø–µ—Ä–µ–ø–µ–ª–æ–≤. –ë–æ–≥–∞—Ç—ã –≤–∏—Ç–∞–º–∏–Ω–∞–º–∏.',
                '–î–æ–º–∞—à–Ω–∏–µ –ø–µ—Ä–µ–ø–µ–ª–∏–Ω—ã–µ —è–π—Ü–∞ –≤—ã—Å—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.'
            ],
            'price_range': (150, 300),
            'unit': '20 —à—Ç',
            'search_terms': ['quail eggs']
        }
    ],
    '–ú—ë–¥': [
        {
            'names': ['–ú—ë–¥ —Ü–≤–µ—Ç–æ—á–Ω—ã–π', '–ú—ë–¥ –ª—É–≥–æ–≤–æ–π', '–ú—ë–¥ —Ä–∞–∑–Ω–æ—Ç—Ä–∞–≤—å–µ'],
            'descriptions': [
                '–ù–∞—Ç—É—Ä–∞–ª—å–Ω—ã–π –º—ë–¥ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–∞—Å–µ–∫–∏. –ê—Ä–æ–º–∞—Ç–Ω—ã–π, –≥—É—Å—Ç–æ–π.',
                '–°–≤–µ–∂–∏–π –º—ë–¥ –Ω–æ–≤–æ–≥–æ —É—Ä–æ–∂–∞—è. –ë–µ–∑ —Å–∞—Ö–∞—Ä–∞ –∏ –¥–æ–±–∞–≤–æ–∫.',
                '–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã–π –º—ë–¥. –û—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω—ã–π –∏ –≤–∫—É—Å–Ω—ã–π.'
            ],
            'price_range': (400, 800),
            'unit': '–∫–≥',
            'search_terms': ['honey']
        },
        {
            'names': ['–ú—ë–¥ –ª–∏–ø–æ–≤—ã–π', '–ú—ë–¥ –∞–∫–∞—Ü–∏–µ–≤—ã–π', '–ú—ë–¥ –≥—Ä–µ—á–∏—à–Ω—ã–π'],
            'descriptions': [
                '–î—É—à–∏—Å—Ç—ã–π –ª–∏–ø–æ–≤—ã–π –º—ë–¥. –ü–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ –ø—Ä–æ—Å—Ç—É–¥–µ.',
                '–°–≤–µ—Ç–ª—ã–π –∞–∫–∞—Ü–∏–µ–≤—ã–π –º—ë–¥. –î–æ–ª–≥–æ –Ω–µ –∫—Ä–∏—Å—Ç–∞–ª–ª–∏–∑—É–µ—Ç—Å—è.',
                '–¢–µ–º–Ω—ã–π –≥—Ä–µ—á–∏—à–Ω—ã–π –º—ë–¥. –ë–æ–≥–∞—Ç –º–∏–∫—Ä–æ—ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.'
            ],
            'price_range': (500, 1000),
            'unit': '–∫–≥',
            'search_terms': ['honey']
        }
    ]
}

# URLs –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
def get_placeholder_image_url(search_term, index):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º URL –¥–ª—è placeholder –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º Unsplash Source API (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
    return f"https://source.unsplash.com/800x600/?{search_term}&sig={index}"

def download_image(url, filename):
    """–°–∫–∞—á–∏–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"""
    try:
        response = requests.get(url, timeout=10)
        if response.status_code == 200:
            filepath = IMAGES_DIR / filename
            with open(filepath, 'wb') as f:
                f.write(response.content)
            return f"/uploads/products/original/{filename}"
    except Exception as e:
        print(f"    ‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {e}")
    return None

total_inserted = 0
total_images = 0

for cat_id, cat_name in categories:
    print(f"\nüì¶ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {cat_name} (ID: {cat_id})")
    
    # –ù–∞—Ö–æ–¥–∏–º –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    category_products = []
    for key, products_list in PRODUCTS_DATA.items():
        if key.lower() in cat_name.lower() or cat_name.lower() in key.lower():
            category_products = products_list
            break
    
    if not category_products:
        print(f"  ‚ö†Ô∏è –ù–µ—Ç —à–∞–±–ª–æ–Ω–æ–≤ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
        continue
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 100 —Ç–æ–≤–∞—Ä–æ–≤
    products_to_generate = min(100, len(category_products) * 15)  # –ü–æ 15 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞
    
    for i in range(products_to_generate):
        # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —Ç–∏–ø —Ç–æ–≤–∞—Ä–∞
        product_template = random.choice(category_products)
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ
        name = random.choice(product_template['names'])
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
        description = random.choice(product_template['descriptions'])
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ü–µ–Ω—É
        price_min, price_max = product_template['price_range']
        price = round(random.uniform(price_min, price_max), 2)
        
        # –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
        unit = product_template['unit']
        
        # –†–µ–π—Ç–∏–Ω–≥ –∏ –æ—Ç–∑—ã–≤—ã
        rating = round(random.uniform(4.0, 5.0), 1)
        reviews_count = random.randint(5, 100)
        
        # –ù–∞–ª–∏—á–∏–µ
        in_stock = random.choice([True, True, True, True, False])  # 80% –≤ –Ω–∞–ª–∏—á–∏–∏
        
        # –í—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä
        try:
            cur.execute("""
                INSERT INTO market.products 
                (name, description, price, category_id, rating, reviews_count, in_stock, unit)
                VALUES (%s, %s, %s, %s, %s, %s, %s, %s)
                RETURNING id
            """, (name, description, price, cat_id, rating, reviews_count, in_stock, unit))
            
            product_id = cur.fetchone()[0]
            total_inserted += 1
            
            # –°–∫–∞—á–∏–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            search_term = random.choice(product_template['search_terms'])
            image_filename = f"product_{product_id}_{i}.jpg"
            
            image_url = download_image(
                get_placeholder_image_url(search_term, i),
                image_filename
            )
            
            if image_url:
                # –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º
                cur.execute("""
                    UPDATE market.products 
                    SET image = %s 
                    WHERE id = %s
                """, (image_url, product_id))
                
                # –î–æ–±–∞–≤–ª—è–µ–º –≤ product_images
                cur.execute("""
                    INSERT INTO market.product_images 
                    (product_id, image_url, is_main, sort_order)
                    VALUES (%s, %s, %s, %s)
                """, (product_id, image_url, True, 0))
                
                total_images += 1
            
            if (i + 1) % 20 == 0:
                print(f"  ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: {i + 1} —Ç–æ–≤–∞—Ä–æ–≤")
                conn.commit()  # –ö–æ–º–º–∏—Ç–∏–º –∫–∞–∂–¥—ã–µ 20 —Ç–æ–≤–∞—Ä–æ–≤
                
        except Exception as e:
            print(f"  ‚ùå –û—à–∏–±–∫–∞: {e}")
            conn.rollback()
            continue
    
    print(f"  ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞: {products_to_generate} —Ç–æ–≤–∞—Ä–æ–≤")

conn.commit()

print(f"\nüéâ –ò–¢–û–ì–û:")
print(f"  üì¶ –¢–æ–≤–∞—Ä–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–æ: {total_inserted}")
print(f"  üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω–æ: {total_images}")
print(f"  üìä –ö–∞—Ç–µ–≥–æ—Ä–∏–π –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {len(categories)}")

cur.close()
conn.close()
