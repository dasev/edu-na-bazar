# ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SMSC.RU –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS

## üéâ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å–µ—Ä–≤–∏—Å **SMSC.RU** –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö SMS —Å –∫–æ–¥–∞–º–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–µ.

---

## üìã –î–µ—Ç–∞–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 1. **Credentials**
```python
SMSC_LOGIN = "dasev"
SMSC_PASSWORD = "AEuO{p%q"
SMSC_API_URL = "https://smsc.ru/sys/send.php"
```

### 2. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª**
`backend/services/sms_service.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `aiohttp` –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω—ã credentials SMSC.RU
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `send_sms()` —Å —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–æ–π

### 3. **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**

```python
async def send_sms(phone: str, code: str) -> bool:
    # 1. –£–±–∏—Ä–∞–µ–º + –∏–∑ –Ω–æ–º–µ—Ä–∞ (SMSC —Ç—Ä–µ–±—É–µ—Ç –±–µ–∑ +)
    phone_clean = phone.replace('+', '')
    
    # 2. –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    message = f"–í–∞—à –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: {code}\n–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 5 –º–∏–Ω—É—Ç.\n\n–ï–¥—É –Ω–∞ –±–∞–∑–∞—Ä"
    
    # 3. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —á–µ—Ä–µ–∑ SMSC API
    params = {
        'login': 'dasev',
        'psw': 'AEuO{p%q',
        'phones': phone_clean,
        'mes': message,
        'charset': 'utf-8',
        'fmt': 3  # JSON –æ—Ç–≤–µ—Ç
    }
    
    # 4. –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç
    response = await session.get(SMSC_API_URL, params=params)
    result = await response.json()
    
    # 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ø–µ—à–Ω–æ—Å—Ç—å
    if 'id' in result:
        # SMS –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ
        return True
```

---

## üì° API Endpoint

### POST `/api/auth/send-sms`

**Request:**
```json
{
  "phone": "+79991234567",
  "full_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",  // –î–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  "email": "ivan@example.com"  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
}
```

**Response (—É—Å–ø–µ—Ö):**
```json
{
  "success": true,
  "message": "SMS –∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω",
  "phone": "+79991234567",
  "expires_in": 300,
  "code": "123456"  // –¢–æ–ª—å–∫–æ –≤ dev —Ä–µ–∂–∏–º–µ!
}
```

**Response (–æ—à–∏–±–∫–∞ SMSC):**
```json
{
  "success": false,
  "error": "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ —Å—á–µ—Ç–µ"
}
```

---

## üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–ª–µ—Ñ–æ–Ω –∏ –§–ò–û
2. –°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
4. –ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `sms_codes`
5. **SMS –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ SMSC.RU**
6. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç SMS —Å –∫–æ–¥–æ–º
7. –í–≤–æ–¥–∏—Ç –∫–æ–¥ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
8. –ü–æ–ª—É—á–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω –Ω–∞ 90 –¥–Ω–µ–π

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–≤—Ö–æ–¥)
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–ª–µ—Ñ–æ–Ω
2. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π –∫–æ–¥
4. **SMS –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ SMSC.RU**
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∫–æ–¥
6. –ü–æ–ª—É—á–∞–µ—Ç JWT —Ç–æ–∫–µ–Ω

---

## üìù –§–æ—Ä–º–∞—Ç SMS —Å–æ–æ–±—â–µ–Ω–∏—è

```
–í–∞—à –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: 123456
–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 5 –º–∏–Ω—É—Ç.

–ï–¥—É –Ω–∞ –±–∞–∑–∞—Ä
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –ö–æ–¥–∏—Ä–æ–≤–∫–∞: UTF-8
- –î–ª–∏–Ω–∞ –∫–æ–¥–∞: 6 —Ü–∏—Ñ—Ä
- –í—Ä–µ–º—è –∂–∏–∑–Ω–∏: 5 –º–∏–Ω—É—Ç
- –ü–æ–¥–ø–∏—Å—å: "–ï–¥—É –Ω–∞ –±–∞–∑–∞—Ä"

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. **–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞**
- –ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 5 –º–∏–Ω—É—Ç
- –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ –≤–≤–æ–¥–∞
- –ü–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∫–æ–¥ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

### 2. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞**
```python
def validate_phone(phone: str) -> bool:
    # –¢–æ–ª—å–∫–æ —Ä–æ—Å—Å–∏–π—Å–∫–∏–µ –Ω–æ–º–µ—Ä–∞: +7XXXXXXXXXX
    return len(phone) == 12 and phone.startswith('+7')
```

### 3. **–•—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–¥–æ–≤**
–¢–∞–±–ª–∏—Ü–∞ `sms_codes`:
```sql
CREATE TABLE sms_codes (
    id UUID PRIMARY KEY,
    phone VARCHAR(20) NOT NULL,
    code VARCHAR(10) NOT NULL,
    expires_at TIMESTAMP NOT NULL,
    is_used BOOLEAN DEFAULT FALSE,
    attempts VARCHAR(10) DEFAULT '0',
    created_at TIMESTAMP DEFAULT NOW()
);
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Dev —Ä–µ–∂–∏–º
–í —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫ SMSC (–Ω–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤, —Å–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞), –∫–æ–¥ –≤—Å–µ —Ä–∞–≤–Ω–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:

```
==================================================
‚ö†Ô∏è  SMSC ERROR: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤
üì± SMS to +79991234567: Your code is 123456
üîê –ö–û–î: 123456
‚è∞ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 5 –º–∏–Ω—É—Ç
==================================================
```

### Production —Ä–µ–∂–∏–º
–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –Ω—É–∂–Ω–æ:
1. –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å SMSC.RU
2. –£–±—Ä–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç –∫–æ–¥–∞ –≤ –æ—Ç–≤–µ—Ç–µ API
3. –£–±—Ä–∞—Ç—å `return True` –≤ –±–ª–æ–∫–µ –æ—à–∏–±–æ–∫

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å SMS

**SMSC.RU —Ç–∞—Ä–∏—Ñ—ã:**
- –†–æ—Å—Å–∏—è: ~2-3 —Ä—É–± –∑–∞ SMS
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ: 100 —Ä—É–±
- –ë–∞–ª–∞–Ω—Å –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ

**–†–∞—Å—á–µ—Ç:**
- 100 —Ä—É–± ‚âà 30-50 SMS
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd backend
pip install aiohttp==3.9.1
```

–ò–ª–∏:
```bash
pip install -r requirements.txt
```

---

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:
```
‚úÖ SMS –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ! ID: 12345
==================================================
‚úÖ SMS –û–¢–ü–†–ê–í–õ–ï–ù–û –ß–ï–†–ï–ó SMSC.RU
üì± –ù–æ–º–µ—Ä: +79991234567
üîê –ö–æ–¥: 123456
üÜî SMS ID: 12345
‚è∞ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 5 –º–∏–Ω—É—Ç
==================================================
```

### –û—à–∏–±–∫–∞ SMSC:
```
‚ùå SMSC Error 2: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –Ω–∞ —Å—á–µ—Ç–µ
```

### –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞:
```
‚ùå Network error: Cannot connect to host smsc.ru
```

---

## üöÄ –ó–∞–ø—É—Å–∫

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
cd backend
pip install -r requirements.txt
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫–µ–Ω–¥:**
```bash
python -m uvicorn main:app --reload
```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:**
- –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
- –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"
- –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- SMS –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä!

---

## üì± –ö–æ–¥—ã –æ—Ç–≤–µ—Ç–æ–≤ SMSC.RU

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `id` | SMS –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ (ID —Å–æ–æ–±—â–µ–Ω–∏—è) |
| `error_code: 1` | –û—à–∏–±–∫–∞ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö |
| `error_code: 2` | –ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å |
| `error_code: 3` | –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ |
| `error_code: 4` | IP –∞–¥—Ä–µ—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω |
| `error_code: 5` | –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã |
| `error_code: 6` | –°–æ–æ–±—â–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ |
| `error_code: 7` | –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–æ–º–µ—Ä–∞ |
| `error_code: 8` | –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —ç—Ç–æ—Ç –Ω–æ–º–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ |

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://smsc.ru/api/http/

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–µ:
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ SMS —á–µ—Ä–µ–∑ SMSC.RU
- ‚úÖ –ö–æ–¥—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ Dev —Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å SMSC.RU –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è!** üì±‚ú®
