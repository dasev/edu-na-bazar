# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## –ü—Ä–æ–±–ª–µ–º–∞
–£ –≤–∞—Å –µ—Å—Ç—å —Å—Ç–∞—Ä–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `enb` –≤ MariaDB, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –Ω–æ–≤—É—é PostgreSQL –±–∞–∑—É.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ (3 –ø—Ä–æ—Å—Ç—ã—Ö —à–∞–≥–∞)

### –®–∞–≥ 1: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—É—é –±–∞–∑—É enb

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
restore_old_database.bat
```

–°–∫—Ä–∏–ø—Ç:
1. –°–æ–∑–¥–∞—Å—Ç –±–∞–∑—É `enb` –≤ MariaDB
2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥–∞–º–ø–∞ `enb_export.sql`
3. –ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ–º–ø–∞–Ω–∏–π, —Ç–æ–≤–∞—Ä–æ–≤)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- MariaDB –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω–∞
- –§–∞–π–ª `enb_export.sql` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
- –ü–∞—Ä–æ–ª—å root –¥–ª—è MariaDB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `root`)

---

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MariaDB

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å MariaDB
mysql -u root -p

# –í –∫–æ–Ω—Å–æ–ª–∏ MariaDB:
USE enb;
SHOW TABLES;
SELECT COUNT(*) FROM user;
SELECT COUNT(*) FROM companies;
SELECT COUNT(*) FROM advert;
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Ç–∞–±–ª–∏—Ü—ã –∏ –¥–∞–Ω–Ω—ã–µ.

---

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é

```bash
cd backend\scripts
python migrate_data.py
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ MariaDB (–±–∞–∑–∞ `enb`)
2. –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ PostgreSQL (–±–∞–∑–∞ `edu_na_bazar`)
3. –ú–∏–≥—Ä–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ:
   - ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (user ‚Üí config.users)
   - ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (categories ‚Üí market.categories)
   - ‚úÖ –ú–∞–≥–∞–∑–∏–Ω—ã (companies ‚Üí market.store_owners)
   - ‚úÖ –¢–æ–≤–∞—Ä—ã (advert ‚Üí market.products)
   - ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (file ‚Üí market.product_images)

---

## üìä –ß—Ç–æ –±—É–¥–µ—Ç –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (user ‚Üí config.users)
- –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (status = 10)
- –¢–µ–ª–µ—Ñ–æ–Ω—ã –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è –∫ —Ñ–æ—Ä–º–∞—Ç—É +7XXXXXXXXXX
- –ï—Å–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –Ω–µ—Ç, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ñ–µ–π–∫–æ–≤—ã–π

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (categories ‚Üí market.categories)
- –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π (parent_id)
- Slug –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ú–∞–≥–∞–∑–∏–Ω—ã (companies ‚Üí market.store_owners)
- –ü—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø–æ user_id
- Status = 'approved' –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π

### –¢–æ–≤–∞—Ä—ã (advert ‚Üí market.products)
- –ü—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ –º–∞–≥–∞–∑–∏–Ω–∞–º (store_owner_id)
- –ü—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (category_id)
- in_stock = true –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (file ‚Üí market.product_images)
- –¢–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ (model = 'advert')
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ—Ä—è–¥–æ–∫ (sort_order)

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –ï—Å–ª–∏ —É –≤–∞—Å –¥—Ä—É–≥–æ–π –ø–∞—Ä–æ–ª—å MariaDB:

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `backend/scripts/migrate_data.py`:

```python
MYSQL_CONFIG = {
    'host': 'localhost',
    'port': 3306,
    'user': 'root',
    'password': '–í–ê–®_–ü–ê–†–û–õ–¨',  # –ò–∑–º–µ–Ω–∏—Ç–µ –∑–¥–µ—Å—å
    'database': 'enb',
    'charset': 'utf8mb4',
    'cursorclass': pymysql.cursors.DictCursor
}
```

### –ï—Å–ª–∏ MariaDB –Ω–∞ –¥—Ä—É–≥–æ–º –ø–æ—Ä—Ç—É:

```python
MYSQL_CONFIG = {
    'host': 'localhost',
    'port': 3307,  # –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç
    ...
}
```

---

## üêõ –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "Access denied for user 'root'"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
mysql -u root
# –í –∫–æ–Ω—Å–æ–ª–∏ MariaDB:
ALTER USER 'root'@'localhost' IDENTIFIED BY 'root';
FLUSH PRIVILEGES;
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Can't connect to MySQL server"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ MariaDB –∑–∞–ø—É—â–µ–Ω–∞
net start MariaDB

# –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Ä—É—á–Ω—É—é
"C:\Program Files\MariaDB 12.1\bin\mysqld.exe"
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Database 'enb' doesn't exist"

**–†–µ—à–µ–Ω–∏–µ:**
–ó–∞–ø—É—Å—Ç–∏—Ç–µ `restore_old_database.bat` –µ—â–µ —Ä–∞–∑.

### –ü—Ä–æ–±–ª–µ–º–∞: "ModuleNotFoundError: No module named 'pymysql'"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
cd backend
pip install pymysql
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
psql -U postgres -d edu_na_bazar

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
SELECT 'Users' as table_name, COUNT(*) FROM config.users
UNION ALL
SELECT 'Categories', COUNT(*) FROM market.categories
UNION ALL
SELECT 'Store Owners', COUNT(*) FROM market.store_owners
UNION ALL
SELECT 'Products', COUNT(*) FROM market.products
UNION ALL
SELECT 'Product Images', COUNT(*) FROM market.product_images;
```

---

## üéØ –ò—Ç–æ–≥–æ

**–ù–ï –ù–£–ñ–ï–ù MySQL 5.7!** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ–∫—É—â—É—é MariaDB 12.1.

**–ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π:**
1. `restore_old_database.bat` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—É—é –±–∞–∑—É
2. `cd backend\scripts && python migrate_data.py` - –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ PostgreSQL

**–í—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏:** 5-15 –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö.

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ú–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–∞ - —Å—Ç–∞—Ä–∞—è –±–∞–∑–∞ –Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è
- –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ (—Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã)
- –í—Å–µ ID –±—É–¥—É—Ç –Ω–æ–≤—ã–µ (–∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç PostgreSQL)
- –§–∏–∑–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω—É–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
